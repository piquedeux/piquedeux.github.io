<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>App Archive by Moritz</title>
<link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div id="container">
    <header>
      <h1>App Archive</h1>
      <h2>by <a href="https://moritzgauss.com">Moritz Gauss</a></h2>
    </header>
    <main>
      <ul class="folder">
        <li class="folder-item">
          <span class="folder-icon">ğŸ“ git.piquedeux.de/</span>
          <ul class="subfolder">
            <!-- dynamisch -->
          </ul>
        </li>
      </ul>
    </main>
  </div>

  <script> 
  document.addEventListener("DOMContentLoaded", () => {
    const repoSuffix = ".app";

    // Folder toggle functionality
    document.querySelectorAll(".folder-item > .folder-icon").forEach((icon) => {
        icon.addEventListener("click", function () {
            const parent = this.parentNode;
            parent.classList.toggle("open");
            const subfolder = parent.querySelector(".subfolder");
            if (subfolder) {
                subfolder.style.display = parent.classList.contains("open") ? "block" : "none";
                this.textContent = parent.classList.contains("open")
                    ? "ğŸ“‚ git.piquedeux.de/"
                    : "ğŸ“ git.piquedeux.de/";
            }
        });
    });

    async function fetchRepos() {
        try {
            const response = await fetch("https://api.github.com/users/piquedeux/repos");
            if (!response.ok) throw new Error("Fehler beim Laden der Repositories");

            const repos = await response.json();
            const subfolder = document.querySelector(".subfolder");
            if (!subfolder) return;

            const filtered = repos
                .filter(repo => !repo.private && repo.name.toLowerCase().endsWith(repoSuffix.toLowerCase()))
                .sort((a, b) => new Date(b.created_at) - new Date(a.created_at));

            for (const repo of filtered) {
                const createdAt = new Date(repo.created_at);
                const month = String(createdAt.getMonth() + 1).padStart(2, "0");
                const year = createdAt.getFullYear();
                const desc = `(${month}/${year})`;

                const li = document.createElement("li");
                li.innerHTML = `
                    <span class="folder-icon">ğŸ“</span>
                    <a href="${location.origin}/${repo.name}/">${repo.name}</a>
                    <span class="description">${desc}</span>
                `;
                subfolder.appendChild(li);
            }
        } catch (error) {
            console.error("Fehler beim Laden der Repositories:", error);
        }
    }

    fetchRepos();
});
  </script>
</body>
</html>
